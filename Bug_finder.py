# coding=utf-8from __future__ import absolute_import, print_functionimport argparseimport torchfrom torch.backends import cudnnfrom evaluations import extract_features, pairwise_distance, pairwise_similarityfrom evaluations import Recall_at_ks, Recall_at_ks_products, Recall_at_ks_shopimport modelsimport DataSetimport osimport numpy as npcudnn.benchmark = Trueos.environ["CUDA_VISIBLE_DEVICES"] = "1"from utils import multi_gpu_loadr = '/opt/intern/users/xunwang/checkpoints/bin/jd/512-4gpu-alpha30/120_model.pth'PATH = rmodel = models.create('vgg', dim=512, pretrained=False)model.load_state_dict(multi_gpu_load(PATH))model = model.cuda()print("Model loaded!!")data = DataSet.create('jd')data_loader = torch.utils.data.DataLoader(    data.gallery, batch_size=64, shuffle=False, drop_last=False)print('Data loaded!!')features, labels = extract_features(model, data_loader, print_freq=5, metric=None)sim_mat = pairwise_similarity(features)result = Recall_at_ks(sim_mat, query_ids=labels, gallery_ids=labels)